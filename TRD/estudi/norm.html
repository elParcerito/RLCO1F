<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="norm.css">
    <script defer src="norm.js"></script>
    <title>APARTADO - ESTUDIANTE</title>
    <style>
      body { font-family: Arial; padding: 20px; }
      #observaciones { margin-top: 20px; }
      .obs { padding: 10px; border-bottom: 1px solid #ccc; }
    </style>
  
    <!-- SDKs de Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  
    <!-- Configuración de Firebase (usa solo una fuente, aquí va embebida) -->
    <script>
      const firebaseConfig = {
        apiKey: "AIzaSyCHYo8LYSyOqgr6tBgo9RXODH0KRwZeowQ",
        authDomain: "live-de-eso.firebaseapp.com",
        projectId: "live-de-eso",
        storageBucket: "live-de-eso.appspot.com",
        messagingSenderId: "250545251960",
        appId: "1:250545251960:web:94ad354f2650d46d32af8d"
      };
      firebase.initializeApp(firebaseConfig);
      const db = firebase.firestore();
    </script>
  
    <script src="../auth-check.js"></script>
  </head>
<body>
    <section id="titl">
        <h2>Bienvenido estudiante.</h2>
        <h3>En este podras ver la informacion de los miembros del equipo de directiva.</h3>
    </section>

<main>
    <section id="ingresar-codigo">
        <h2>Ingrese el Cargo</h2>
        <p>
            <span style="color: red;">Presi</span>dente, <span style="color: red;">Vice</span>presidente, <span style="color: red;">Sec</span>retario, 
            <br>
            <span style="color: red;">Teso</span>rero, Delegado de <span style="color: red;">apoyo</span> 
            <br> 
            directivo, Delegado de <span style="color: red;">trabajos</span>, 
            <br>
            Delegado de <span style="color: red;">deporte</span> y convivencia
        </p>
        <br>
        <br>
        <input type="text" id="codigo" placeholder="Ingrese el Cargo">
        <button onclick="verDetalles()">INGRESAR</button>
        <br><br><br><br><br>
    </section>
<br>
<br>
<br>
<section id="detalles-entrega" style="display: none;">
    <h1>Detalles De Cargos</h1>
    <ul id="listaDatos">
        <strong>Nombre:</strong> <span id="nombre"></span>
        <br><br>
        <strong>Cargo:</strong> <span id="cargo"></span>
        <br><br>
        <strong>Funciones o responsabilidades:</strong> <span id="funciones"></span>
        <br><br>
        <strong>Contacto:</strong> <span id="contacto"></span>
        <br><br>
                
    </ul>
</section>
</main>


  <div id="avisos">
    <h2>Lista de avisos</h2>
    <div id="listaAvisos"></div>
  </div>

  <script>
    function escapeHTML(text) {
      const div = document.createElement("div");
      div.textContent = text;
      return div.innerHTML;
    }

    // Mostrar avisos en tiempo real
    db.collection("avisos").orderBy("fechaSubida", "desc").onSnapshot((querySnapshot) => {
      const contenedor = document.getElementById("listaAvisos");
      contenedor.innerHTML = "";
      querySnapshot.forEach((doc) => {
        const data = doc.data();
        const fechaEvento = data.fechaEvento?.toDate?.() ? data.fechaEvento.toDate().toLocaleDateString() : "Sin fecha";
        const fechaSubida = data.fechaSubida?.toDate?.() ? data.fechaSubida.toDate().toLocaleString() : "Sin registro";

        contenedor.innerHTML += `
          <div class="aviso" style="border-bottom: 1px solid #ccc; margin-bottom: 15px; padding-bottom: 10px;">
            <h3>${escapeHTML(fechaEvento)} — ${escapeHTML(data.descripcion)}</h3>
            <p><strong>Publicado por:</strong> ${escapeHTML(data.remitente)}</p>
            <small>Publicado el ${fechaSubida}</small><br>
          </div>
        `;
      });
    });

    function guardarAviso(event) {
      event.preventDefault();
      const remitente = document.getElementById("remitente").value.trim();
      const descripcion = document.getElementById("descripcion").value.trim();
      const fechaEvento = document.getElementById("fechaEvento").value;

      if (!remitente || !descripcion || !fechaEvento) {
        alert("Por favor completa todos los campos.");
        return;
      }

      db.collection("avisos").add({
        remitente,
        descripcion,
        fechaEvento: firebase.firestore.Timestamp.fromDate(new Date(fechaEvento + "T12:00:00")),
        fechaSubida: firebase.firestore.FieldValue.serverTimestamp()
      }).then(() => {
        alert("Aviso enviado con éxito ✅");
        document.getElementById("formularioAviso").reset();
      });
    }
  </script>
</body>
</html>
